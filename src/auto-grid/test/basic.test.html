<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>pwc-auto-grid: basic</title>
  <script type="module" src="../../../dist/auto-grid.js"></script>
  <style>
    pwc-auto-grid > * {
      box-sizing: border-box;
      background: #e8f0fe;
      border: 1px solid #9fb8e8;
      padding: 0.4rem 0.8rem;
    }
    pwc-auto-grid > .pwc-auto-grid-wide {
      background: #fce8c8;
      border-color: #e0aa5a;
    }

    .w300 { width: 300px; outline: 1px dashed #bbb; }

    .no-attr-support {
      display: block;
      margin: 1rem 0;
      padding: 0.6rem 1rem;
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 4px;
    }

    @supports (width: attr(x type(<length>), 0px)) {
      .no-attr-support { display: none; }
    }
  </style>
</head>

<body>

<h1>pwc-auto-grid: basic</h1>

<p class="no-attr-support">
  ⚠ This browser does not support CSS <code>attr()</code> with type keywords — this test
  will fail. See <a href="css-properties.test.html">css-properties.test.html</a> for a
  test that works without this feature.
</p>

<!-- ── Auto-fit default ────────────────────────────────────────────────────── -->

<h2>Auto-fit (default)</h2>
<p>Columns are at least 100px wide and grow to fill the available space.</p>

<pwc-auto-grid id="probe">
  <div>Item 1</div>
  <div>Item 2</div>
  <div>Item 3</div>
  <div>Item 4</div>
  <div>Item 5</div>
  <div>Item 6</div>
</pwc-auto-grid>

<!-- ── Attribute shorthand — fixed columns ────────────────────────────────── -->

<h2>Fixed columns via <code>cols="3"</code> — items 1–3 share a row, item 4 wraps</h2>

<div class="w300">
  <pwc-auto-grid id="grid-attr" cols="3" gap="0px" min-width="1px">
    <div id="attr-1">Item 1</div>
    <div id="attr-2">Item 2</div>
    <div id="attr-3">Item 3</div>
    <div id="attr-4">Item 4 (wraps)</div>
  </pwc-auto-grid>
</div>

<!-- ── Attribute shorthand — full-width item ──────────────────────────────── -->

<h2>Full-width item via <code>cols="3"</code> — <code>.pwc-auto-grid-wide</code> spans all columns</h2>

<div class="w300">
  <pwc-auto-grid id="grid-attr-wide" cols="3" gap="0px" min-width="1px">
    <div id="attr-wide" class="pwc-auto-grid-wide">⟵ spans all 3 columns ⟶</div>
    <div id="attr-wide-rest">Item 1</div>
  </pwc-auto-grid>
</div>

<!-- ── Attribute shorthand — max-width cap ────────────────────────────────── -->

<h2>Max-width cap via <code>max-width="100px"</code> — 2 items in 300px auto-fit, each capped at 100px</h2>

<div class="w300">
  <pwc-auto-grid id="grid-attr-maxwidth" gap="0px" min-width="1px" max-width="100px">
    <div id="attr-mw-1">Item 1</div>
    <div id="attr-mw-2">Item 2</div>
  </pwc-auto-grid>
</div>

<!-- ── Switcher ───────────────────────────────────────────────────────────── -->

<h2>Switcher — fits (3 × 80px = 240px ≤ 300px → one row)</h2>

<div class="w300">
  <pwc-auto-grid id="switcher-fits" class="switcher" cols="3" gap="0px" min-width="80px">
    <div id="sw-fit-1">Item 1</div>
    <div id="sw-fit-2">Item 2</div>
    <div id="sw-fit-3">Item 3</div>
  </pwc-auto-grid>
</div>

<h2>Switcher — breaks (3 × 120px = 360px &gt; 300px → each item full width)</h2>

<div class="w300">
  <pwc-auto-grid id="switcher-breaks" class="switcher" cols="3" gap="0px" min-width="120px">
    <div id="sw-brk-1">Item 1</div>
    <div id="sw-brk-2">Item 2</div>
    <div id="sw-brk-3">Item 3</div>
  </pwc-auto-grid>
</div>

<script type="module">
  import { run } from "../../../static/testing/harness.js";
  import * as assert from "../../../static/testing/assert.js";

  run(async ({ log, nextTick }) => {

    await nextTick("wait for CSS");

    // ── CSS registered ─────────────────────────────────────────────────────

    await log("CSS injected: display:grid applied");
    assert.equal(getComputedStyle(document.getElementById("probe")).display, "grid");

    // ── Attribute shorthand: fixed columns ─────────────────────────────────

    await log("cols=3: items 1–3 share a row, item 4 wraps");
    const a1 = document.getElementById("attr-1");
    const a2 = document.getElementById("attr-2");
    const a3 = document.getElementById("attr-3");
    const a4 = document.getElementById("attr-4");

    assert.width(a1, 100);
    assert.top(a1, a2);
    assert.top(a1, a3);
    assert.above(a1, a4);

    // ── Attribute shorthand: full-width item ───────────────────────────────

    await log("cols=3: wide item spans full container width");
    const wide = document.getElementById("attr-wide");
    const rest = document.getElementById("attr-wide-rest");

    assert.width(wide, 300);
    assert.above(wide, rest);

    // ── Attribute shorthand: max-width cap ─────────────────────────────────

    await log("max-width=100px: 2 cols in 300px each capped at 100px");
    assert.width(document.getElementById("attr-mw-1"), 100);

    // ── Switcher ───────────────────────────────────────────────────────────

    await log("switcher fits: all 3 items in one row");
    assert.top(document.getElementById("sw-fit-1"), document.getElementById("sw-fit-2"));
    assert.top(document.getElementById("sw-fit-1"), document.getElementById("sw-fit-3"));

    await log("switcher breaks: each item takes full width");
    const sb1 = document.getElementById("sw-brk-1");
    const sb2 = document.getElementById("sw-brk-2");
    const sb3 = document.getElementById("sw-brk-3");

    assert.width(sb1, 300);
    assert.above(sb1, sb2);
    assert.above(sb2, sb3);

    await log("done");
  });
</script>
</body>
</html>
